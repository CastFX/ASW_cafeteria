<!DOCTYPE html>
<html lang="it">
<head>

  <title>Home</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="static/css/reset.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>
  <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  <link rel="stylesheet" href="static/css/ticket.css">
</head>

<body>
<div id="app">

    <div v-cloak v-if="dataReady">
        <div class='container' id ='homepage'>
            <h1>Lives left: {{lives}}</h1>
            <button v-on:click='startGame' :disabled="lives <= 0">Play</button>
        </div>
    </div>

    <div class="text-center" v-if="!dataReady">
        <div class="spinner-border" role="status">
        <span class="sr-only">Loading...</span>
        </div>
    </div>

</div>
</body>

<script src="https://cdn.jsdelivr.net/npm/vue"></script>
<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
<script src="https://npmcdn.com/vue-router/dist/vue-router.js"></script>
<script>
var tickets = {
  idTipoTicket: {
    type:'',
    discount:'',
    description:'',
    image:''
  }
};

var app = new Vue({
	el:	"#app",
	data:	{
		lives: 0,
        dataReady: false
	},
	methods: {
        startGame: function(event) {
            
            axios.get("api/createGameSession")
                .then(response => {
                    console.log("click on startGame");
                    window.location.href = "/hextris/game/" + response.data;
                })
                .catch(error => console.log(error))
        },
        setLives: function() {
            axios.get("api/lives")
                .then(response => {
                    this.lives = response.data; 
                    this.dataReady = true;
                })
                .catch(error => (console.log(error))) //Gestione errori approssimativa
        },
		init: function(){
			this.setLives();
		}
	},
	mounted(){
		this.init();
	}
});
</script>

</html>
